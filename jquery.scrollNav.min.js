(function(e){e.fn.scrollNav=function(t){var n=e.extend({sections:"h2",subSections:!1,showHeadline:!0,headlineText:"Scroll To",showTopLink:!0,topLinkText:"Top",fixedMargin:40,scrollOffset:40,animated:!0,speed:500,location:"insertBefore"},t),r,i,s=[],o=[],u=this,a=e("<span />",{"class":"scroll-nav__heading",text:n.headlineText}),f=e("<div />",{"class":"scroll-nav__wrapper"}),l=e("<nav />",{"class":"scroll-nav",role:"navigation"}),c=function(){e("body").addClass("sn-loading")},h=function(t){t?e("body").removeClass("sn-loading").addClass("sn-active"):e("body").removeClass("sn-loading").addClass("sn-failed")},p=function(){n.showTopLink&&s.push(u.children().first().nextUntil(n.sections).andSelf());u.find(n.sections).each(function(){s.push(e(this).nextUntil(n.sections).andSelf())})},d=function(){e(s).each(function(t){var r=[],i=e(this),s="scrollNav-"+(t+1),u=i.offset().top,a=n.showTopLink&&t===0?n.topLinkText:i.filter(n.sections).text();if(n.subSections){var f=i.filter(n.subSections);if(f.length>0){f.each(function(t){var n=s+"-"+(t+1),o=e(this).offset().top,u=e(this).text(),a=i.filter(e(this).nextUntil(f).andSelf());a.wrapAll('<div id="'+n+'" class="scroll-nav__sub-section" />');r.push({id:n,offset:o,text:u})});i=e(this).nextUntil(n.sections).andSelf()}}i.wrapAll('<section id="'+s+'" />');o.push({id:s,offset:u,text:a,subSections:r})})},v=function(){var t=e("<ol />",{"class":"scroll-nav__list"});e.each(o,function(n){var r=n===0?e("<li />",{"class":"scroll-nav__item active"}):e("<li />",{"class":"scroll-nav__item"}),i=e("<a />",{href:"#"+this.id,"class":"scroll-nav__link",text:this.text}),s;if(this.subSections.length>0){r.addClass("is-parent-item");s=e("<ol />",{"class":"scroll-nav__sub-list"});e.each(this.subSections,function(){var t=e("<li />",{"class":"scroll-nav__sub-item"}),n=e("<a />",{href:"#"+this.id,"class":"scroll-nav__sub-link",text:this.text});s.append(t.append(n))})}t.append(r.append(i).append(s))});n.showHeadline?l.append(f.append(a).append(t)):l.append(f.append(t))},m=function(){l[n.location](u)},g=function(){r=e(window).height();i=l.offset().top;e.each(o,function(){var t=e("#"+this.id),n=t.height();this.topOffset=t.offset().top;this.bottomOffset=this.topOffset+n})},y=function(){var t=e(window).scrollTop(),s=t+n.scrollOffset,u=t+r-n.scrollOffset,a=[];t>i-n.fixedMargin?l.addClass("fixed"):l.removeClass("fixed");e.each(o,function(){(this.topOffset>s&&this.topOffset<u||this.bottomOffset>s&&this.bottomOffset<u||this.topOffset<s&&this.bottomOffset>u)&&a.push(this)});l.find(".scroll-nav__item").removeClass("active");e.each(a,function(){l.find('a[href="#'+this.id+'"]').parents(".scroll-nav__item").addClass("active")})},b=function(){e(window).resize(function(){g();y()});e(window).scroll(function(){y()})},w=function(){n.animated&&e(".scroll-nav").find("a").click(function(t){t.preventDefault();var r=e(this).attr("href"),i=e(r).offset().top;e("html:not(:animated),body:not(:animated)").animate({scrollTop:i-n.scrollOffset},n.speed)})};if(u.length>0){c();p();if(u.find(n.sections).length>0){d();v();m();g();y();b();w();h(!0)}else{console.log('Build failed, scrollNav could not find any "'+n.sections+'s" inside of "'+u.selector+'"');h(!1)}}else{console.log('Build failed, scrollNav could not find "'+u.selector+'"');h(!1)}}})(jQuery);